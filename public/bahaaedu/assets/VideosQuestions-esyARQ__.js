import{_ as m,u as p,a as n,r as b,o as d,c as u,b as o,j as g,t as l,n as f,e as v}from"./index-ClkC-KWi.js";import{Q as _,s as w}from"./shuffleArray-qmA_B5Fe.js";const x={name:"VideosQuestions",components:{Question:_},data(){return{videos:[],video:{},question:{},currentPage:1,totalPages:1,toast:p()}},mounted(){this.getVideos(),this.$store.dispatch("clearAnswers")},methods:{getVideos(){n.get(`/videos/${this.$route.params.id}`,{headers:{Authorization:`Bearer ${this.$store.state.token}`}}).then(e=>{const s=e.data.questions.map(i=>(Object.keys(i).forEach(t=>{i[t]===null&&delete i[t]}),i));this.videos=w(s),this.totalPages=this.videos.length,this.question=this.videos[0],this.video=e.data.video_ditails,this.canSubmit()}).catch(e=>{e.response&&e.response.status===401&&(this.toast.error("خطأ: غير مصرح به"),this.$store.commit("logout"),this.$router.push("/bahaaedu/login")),e.response&&e.response.status===500&&(this.toast.error(e.response.data.error),this.$router.push("/bahaaedu/dashboard"))})},ChangeQuestion(e){this.currentPage=e,this.question=this.videos[this.currentPage-1]},submitAnswers(){this.canSubmit&&n.post(`/videos/${this.$route.params.id}`,this.$store.state.answers,{headers:{Authorization:`Bearer ${this.$store.state.token}`,"Content-Type":"application/json"}}).then(e=>{const s=e.data.message;this.toast.success(s),this.$router.push("/bahaaedu/videos")}).catch(e=>{e.response&&e.response.status===401?(this.toast.error("خطأ: غير مصرح به"),this.$store.commit("logout"),this.$router.push("/bahaaedu/login")):this.toast.error(e.response.error)})}},computed:{canSubmit(){return this.totalPages===this.$store.state.answers.length}},watch:{currentPage(e){this.ChangeQuestion(e)}}},y={class:"w-full max-w-screen-xl flex justify-center items-center flex-col gap-4 px-4 pb-8 mx-auto lg:gap-8 xl:gap-0"},P={class:"video_card shadow-lg rounded-md aspect-video w-full mb-10 overflow-hidden"},k={class:"videoWrapper overflow-hidden w-full h-full"},C=["src"],Q={key:0,class:"solved"},A={class:"questions w-full px-4 flex flex-col gap-4 items-center justify-center max-w-3xl"},S={class:"buttons flex flex-col gap-4 mt-10 w-full justify-center items-center"},V={class:"flex gap-4"},j=["disabled"],$={class:"current-page p-2 rounded-md bg-primary text-white"},q=["disabled"],B=["disabled"];function z(e,s,i,c,t,r){const h=b("Question");return d(),u("div",y,[o("div",P,[o("div",k,[o("iframe",{src:t.video.link,frameborder:"0",allowfullscreen:"",style:{width:"100%",height:"100%"}},null,8,C)])]),t.video.isSolved?v("",!0):(d(),u("div",Q,[o("div",A,[g(h,{question:t.question,index:t.currentPage},null,8,["question","index"])]),o("div",S,[o("div",V,[o("button",{class:"btn btn-primary border border-primary rounded-md p-2 hover:bg-primary hover:text-white duration-300 disabled:cursor-not-allowed disabled:opacity-50",onClick:s[0]||(s[0]=a=>r.ChangeQuestion(t.currentPage+1)),disabled:t.currentPage===t.totalPages}," التالي ",8,j),o("div",$,l(t.currentPage)+" / "+l(t.totalPages),1),o("button",{class:"btn btn-primary border border-primary rounded-md p-2 hover:bg-primary hover:text-white duration-300 disabled:cursor-not-allowed disabled:opacity-50",onClick:s[1]||(s[1]=a=>r.ChangeQuestion(t.currentPage-1)),disabled:t.currentPage===1}," السابق ",8,q)]),o("button",{onClick:s[2]||(s[2]=(...a)=>r.submitAnswers&&r.submitAnswers(...a)),class:f(["btn btn-primary border bg-primary text-white rounded-md p-2 hover:bg-white hover:text-primary hover:border-primary duration-300 w-48",{"opacity-50 cursor-not-allowed":!r.canSubmit}]),disabled:!r.canSubmit}," إرسال الاجابات ",10,B)])]))])}const T=m(x,[["render",z]]);export{T as default};
