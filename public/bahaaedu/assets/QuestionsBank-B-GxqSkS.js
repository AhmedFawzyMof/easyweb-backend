import{_ as m,u as b,a as l,r as g,o as a,c as u,j as p,b as r,t as c,n as f}from"./index-ClkC-KWi.js";import{Q as x,s as y}from"./shuffleArray-qmA_B5Fe.js";const w={name:"QuestionsBank",components:{Question:x},data(){return{questions:[],question:{},currentPage:1,totalPages:1,toast:b()}},mounted(){this.getQuestions(),this.$store.dispatch("clearAnswers")},methods:{getQuestions(){l.get("/questions/bank",{headers:{Authorization:`Bearer ${this.$store.state.token}`}}).then(t=>{const s=t.data.map(n=>(Object.keys(n).forEach(e=>{n[e]===null&&delete n[e]}),n));this.questions=y(s),this.totalPages=this.questions.length,this.question=this.questions[0]}).catch(t=>{t.response&&t.response.status===401&&(this.toast.error("خطأ: غير مصرح به"),this.$store.commit("logout"),this.$router.push("/bahaaedu/login"))})},ChangeQuestion(t){this.currentPage=t,this.question=this.questions[this.currentPage-1]},submitAnswers(){this.canSubmit&&l.post("/questions",this.$store.state.answers,{headers:{Authorization:`Bearer ${this.$store.state.token}`}}).then(t=>{this.toast.success(t.data.message),this.toast.success(t.data.result),this.getQuestions()}).catch(t=>{t.response&&t.response.status===401&&(this.toast.error("خطأ: غير مصرح به"),this.$store.commit("logout"),this.$router.push("/bahaaedu/login"))})}},computed:{canSubmit(){return this.totalPages===this.$store.state.answers.length}},watch:{currentPage(t){this.ChangeQuestion(t)}}},_={class:"w-full flex justify-center items-center flex-col gap-10"},v={key:0,class:"questions w-full px-4 flex flex-col gap-4 items-center justify-center max-w-3xl"},P={key:1,class:"questions w-full px-4 flex flex-col gap-4 items-center justify-center max-w-3xl"},k={class:"buttons flex flex-col gap-4 mt-10 w-full justify-center items-center"},q={class:"flex gap-4"},Q=["disabled"],C={class:"current-page p-2 rounded-md bg-primary text-white"},A=["disabled"],B=["disabled"];function j(t,s,n,d,e,o){const h=g("Question");return a(),u("div",_,[e.questions.length>0?(a(),u("div",v,[p(h,{question:e.question,index:e.currentPage},null,8,["question","index"])])):(a(),u("div",P," لا يوجد اسئلة ")),r("div",k,[r("div",q,[r("button",{class:"btn btn-primary border border-primary rounded-md p-2 hover:bg-primary hover:text-white duration-300 disabled:cursor-not-allowed disabled:opacity-50",onClick:s[0]||(s[0]=i=>o.ChangeQuestion(e.currentPage+1)),disabled:e.currentPage===e.totalPages}," التالي ",8,Q),r("div",C,c(e.currentPage)+" / "+c(e.totalPages),1),r("button",{class:"btn btn-primary border border-primary rounded-md p-2 hover:bg-primary hover:text-white duration-300 disabled:cursor-not-allowed disabled:opacity-50",onClick:s[1]||(s[1]=i=>o.ChangeQuestion(e.currentPage-1)),disabled:e.currentPage===1}," السابق ",8,A)]),r("button",{onClick:s[2]||(s[2]=(...i)=>o.submitAnswers&&o.submitAnswers(...i)),class:f(["btn btn-primary border bg-primary text-white rounded-md p-2 hover:bg-white hover:text-primary hover:border-primary duration-300 w-48",{"opacity-50 cursor-not-allowed":!o.canSubmit}]),disabled:!o.canSubmit}," إرسال الاجابات ",10,B)])])}const E=m(w,[["render",j]]);export{E as default};
