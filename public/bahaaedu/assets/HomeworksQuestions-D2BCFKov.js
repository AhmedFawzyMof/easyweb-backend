import{_ as c,u as l,a as n,r as m,o as p,c as b,b as o,j as g,t as u,n as w}from"./index-ClkC-KWi.js";import{Q as f,s as y}from"./shuffleArray-qmA_B5Fe.js";const x={name:"HomeworksQuestions",components:{Question:f},data(){return{homework:[],question:{},currentPage:1,totalPages:1,toast:l()}},mounted(){this.getHomework(),this.$store.dispatch("clearAnswers")},methods:{getHomework(){n.get(`/homeworks/${this.$route.params.id}`,{headers:{Authorization:`Bearer ${this.$store.state.token}`}}).then(e=>{const s=e.data.map(a=>(Object.keys(a).forEach(t=>{a[t]===null&&delete a[t]}),a));this.homework=y(s),this.totalPages=this.homework.length,this.question=this.homework[0],this.canSubmit()}).catch(e=>{e.response&&e.response.status===401&&(this.toast.error("خطأ: غير مصرح به"),this.$store.commit("logout"),this.$router.push("/bahaaedu/login")),e.response&&e.response.status===500&&(this.toast.error(e.response.data.error),this.$router.push("/bahaaedu/dashboard"))})},ChangeQuestion(e){this.currentPage=e,this.question=this.homework[this.currentPage-1]},submitAnswers(){this.canSubmit&&n.post(`/homeworks/${this.$route.params.id}`,this.$store.state.answers,{headers:{Authorization:`Bearer ${this.$store.state.token}`,"Content-Type":"application/json"}}).then(e=>{const s=e.data.message;this.toast.success(s),this.$router.push("/bahaaedu/dashboard")}).catch(e=>{e.response&&e.response.status===401?(this.toast.error("خطأ: غير مصرح به"),this.$store.commit("logout"),this.$router.push("/bahaaedu/login")):this.toast.error(e.response.error)})}},computed:{canSubmit(){return this.totalPages===this.$store.state.answers.length}},watch:{currentPage(e){this.ChangeQuestion(e)}}},_={class:"w-full flex justify-center items-center flex-col gap-10"},k={class:"questions w-full px-4 flex flex-col gap-4 items-center justify-center max-w-3xl"},v={class:"buttons flex flex-col gap-4 mt-10 w-full justify-center items-center"},P={class:"flex gap-4"},C=["disabled"],Q={class:"current-page p-2 rounded-md bg-primary text-white"},A=["disabled"],$=["disabled"];function j(e,s,a,h,t,r){const d=m("Question");return p(),b("div",_,[o("div",k,[g(d,{question:t.question,index:t.currentPage},null,8,["question","index"])]),o("div",v,[o("div",P,[o("button",{class:"btn btn-primary border border-primary rounded-md p-2 hover:bg-primary hover:text-white duration-300 disabled:cursor-not-allowed disabled:opacity-50",onClick:s[0]||(s[0]=i=>r.ChangeQuestion(t.currentPage+1)),disabled:t.currentPage===t.totalPages}," التالي ",8,C),o("div",Q,u(t.currentPage)+" / "+u(t.totalPages),1),o("button",{class:"btn btn-primary border border-primary rounded-md p-2 hover:bg-primary hover:text-white duration-300 disabled:cursor-not-allowed disabled:opacity-50",onClick:s[1]||(s[1]=i=>r.ChangeQuestion(t.currentPage-1)),disabled:t.currentPage===1}," السابق ",8,A)]),o("button",{onClick:s[2]||(s[2]=(...i)=>r.submitAnswers&&r.submitAnswers(...i)),class:w(["btn btn-primary border bg-primary text-white rounded-md p-2 hover:bg-white hover:text-primary hover:border-primary duration-300 w-48",{"opacity-50 cursor-not-allowed":!r.canSubmit}]),disabled:!r.canSubmit}," إرسال الاجابات ",10,$)])])}const q=c(x,[["render",j]]);export{q as default};
