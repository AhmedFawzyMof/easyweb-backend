import{_,f as p,o as n,c as d,a as e,t as c,j as u,g as a,k as f,l as g,m as h,F as b,h as y,n as x}from"./index-8f04eNzw.js";const w={name:"Checkout",data(){return{loaded:!1,discount:0,paypal:!1,method:"",code:"",cart:{items:[]},first_name:"",last_name:"",email:"",phone:"",phone2:"",address:"",errors:[]}},async mounted(){const o=document.createElement("script");o.setAttribute("data-namespace","paypal_sdk"),o.src="https://www.paypal.com/sdk/js?client-id=AU4ECLDAlYkHzUEY5h4J3AvPN0sCi7P0aU5FL2QoSArKMRqwmok_mKp9Iq11GKU8HA0qlsN1uEkmAJjH",o.addEventListener("load",this.setLoaded),document.body.appendChild(o),this.$store.state.Lang?document.title="الدفع | المنزل":document.title="Checkout | المنزل",this.cart=this.$store.state.cart,this.cart.items.length==0&&this.$router.push("/cart"),this.method="cash"},methods:{getItemTotal(o){return o.quantity*o.product.price},Form(){if(this.errors=[],this.first_name===""&&this.errors.push({message:"The first name is missing "}),this.last_name===""&&this.errors.push({message:"The last name is missing "}),this.$store.state.isAuthenticated||this.email===""&&this.errors.push({message:"The email is missing "}),this.phone===""&&this.errors.push({message:"The phone is missing "}),this.phone2===""&&this.errors.push({message:"The Spare Phone Number is missing "}),this.address===""&&this.errors.push({message:"The address is missing "}),this.errors.length>0)return;const o=this.first_name+" "+this.last_name,s=[];for(let r=0;r<this.cart.items.length;r++){const t=this.cart.items[r];let l={};t.color?l={product:t.product.id,quantity:t.quantity,color:t.color}:l={product:t.product.id,quantity:t.quantity},s.push(l)}const m={name:o,email:this.email,method:this.method,phone:this.phone,spare_phone:this.phone2,address:this.address,items:s};this.$store.state.isAuthenticated?(this.$store.state.loading=!0,p.post("/api/order",m).then(r=>{this.$store.state.loading=!1,r.data.Error,this.$store.commit("clearCart"),this.$router.push("/order/success")})):(this.$store.state.loading=!0,p.post("/api/order",m).then(r=>{this.$store.state.loading=!1,r.data.Error,this.$store.commit("clearCart"),this.$router.push("/order/success")}))}},computed:{cartTotalLength(){return this.cart.items.reduce((o,s)=>o+=s.quantity,0)},cartTotalPrice(){return this.cart.items.reduce((o,s)=>o+=s.product.price*s.quantity,0)},shippingPrice(){return this.cartTotalPrice*.1}}},v={class:"mx-5 max-w-screen-xl px-4 py-8 sm:px-6 sm:py-12 lg:px-8"},P={class:"w-full flex flex-col sm:flex-row-reverse gap-5"},k={class:"w-full sm:w-1/2"},T={class:"mt-1 flex justify-center pt-8"},C={class:"w-full space-y-4"},E={class:"space-y-0.5 text-sm text-gray-700"},j={class:"flex justify-between"},A=e("dt",null,"Subtotal",-1),L={class:"flex justify-between"},U=e("dt",null,"Shipping",-1),q={class:"flex justify-between"},F=e("dt",null,"Proudcts",-1),M={key:0,class:"flex justify-between"},N=e("dt",null,"Discount",-1),V=e("dd",null,"-£20",-1),S=[N,V],z={class:"flex justify-between !text-base font-medium"},B=e("dt",null,"Total",-1),D={class:"w-full sm:w-1/2"},G={class:"flex flex-wrap gap-3"},H=e("legend",{class:"sr-only"},"Payment Method",-1),I={for:"cash",class:"flex cursor-pointer items-center justify-center rounded-md border border-gray-100 bg-white px-3 py-2 text-gray-900 hover:border-gray-200 has-[:checked]:border-blue-500 has-[:checked]:bg-blue-500 has-[:checked]:text-white"},K=e("p",{class:"text-sm font-medium"},"Cash",-1),J={class:"input grid gap-2 w-full"},R=e("label",null,"First Name",-1),Y={class:"input grid gap-2 w-full mt-4"},O=e("label",null,"Last Name",-1),Q={key:0,class:"input grid gap-2 w-full mt-4"},W=e("label",null,"Email",-1),X={class:"input grid gap-2 w-full mt-4"},Z=e("label",null,"Phone",-1),$={class:"input grid gap-2 w-full mt-4"},ee=e("label",null,"Spare Phone",-1),te={class:"input grid gap-2 w-full mt-4"},se=e("label",null,"Address",-1),ie={key:1,role:"alert",class:"rounded border-s-4 border-red-500 bg-red-50 p-4 w-full mt-4"},oe={class:"flex items-center gap-2 text-red-800 mt-3"},le=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"h-5 w-5"},[e("path",{"fill-rule":"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z","clip-rule":"evenodd"})],-1),re={class:"block font-medium capitalize"},ne=e("div",{class:"mt-4 bg-red-600 text-white w-full h-11 rounded-md grid place-items-center text-xl cursor-pointer hover:bg-red-700 hover:text-white transition-all"}," Order ",-1);function de(o,s,m,r,t,l){return n(),d("div",v,[e("div",P,[e("div",k,[e("div",T,[e("div",C,[e("dl",E,[e("div",j,[A,e("dd",null,c(l.cartTotalPrice)+" EGP",1)]),e("div",L,[U,e("dd",null,c(l.shippingPrice.toFixed(2))+" EGP",1)]),e("div",q,[F,e("dd",null,c(l.cartTotalLength),1)]),t.discount!=0?(n(),d("div",M,S)):u("",!0),e("div",z,[B,e("dd",null,c((l.cartTotalPrice+l.shippingPrice).toFixed(2))+" EGP",1)])])])])]),e("div",D,[e("fieldset",G,[H,e("div",null,[e("label",I,[a(e("input",{type:"radio",name:"PaymentMethod",value:"cash","onUpdate:modelValue":s[0]||(s[0]=i=>t.method=i),onInput:s[1]||(s[1]=i=>o.ChingeTheMethod("cash")),id:"cash",class:"sr-only",checked:""},null,544),[[f,t.method]]),K])])]),t.method=="cash"?(n(),d("form",{key:0,onSubmit:s[8]||(s[8]=g((...i)=>l.Form&&l.Form(...i),["prevent"])),class:"mt-5 flex items-start flex-col justify-center"},[e("div",J,[R,a(e("input",{class:"border-b border-solid w-full",type:"text","onUpdate:modelValue":s[2]||(s[2]=i=>t.first_name=i),placeholder:"FirstName..."},null,512),[[h,t.first_name]])]),e("div",Y,[O,a(e("input",{class:"border-b border-solid w-full",type:"text","onUpdate:modelValue":s[3]||(s[3]=i=>t.last_name=i),placeholder:"LastName..."},null,512),[[h,t.last_name]])]),this.$store.state.isAuthenticated?u("",!0):(n(),d("div",Q,[W,a(e("input",{class:"border-b border-solid w-full",type:"text","onUpdate:modelValue":s[4]||(s[4]=i=>t.email=i),placeholder:"Email..."},null,512),[[h,t.email]])])),e("div",X,[Z,a(e("input",{class:"border-b border-solid w-full",type:"tel","onUpdate:modelValue":s[5]||(s[5]=i=>t.phone=i),placeholder:"Phone..."},null,512),[[h,t.phone]])]),e("div",$,[ee,a(e("input",{class:"border-b border-solid w-full",type:"tel","onUpdate:modelValue":s[6]||(s[6]=i=>t.phone2=i),placeholder:"Spare Phone..."},null,512),[[h,t.phone2]])]),e("div",te,[se,a(e("textarea",{class:"border rounded-lg","onUpdate:modelValue":s[7]||(s[7]=i=>t.address=i),cols:"30",rows:"5"},`
            `,512),[[h,t.address]])]),t.errors.length>0?(n(),d("div",ie,[(n(!0),d(b,null,y(t.errors,i=>(n(),d("div",oe,[le,e("strong",re,c(i.message),1)]))),256))])):u("",!0),ne],32)):u("",!0),e("div",{class:x([{flex:t.paypal,hidden:!t.paypal},"mt-5"]),id:"PayPalButtons"},null,2)])])])}const he=_(w,[["render",de]]);export{he as default};
